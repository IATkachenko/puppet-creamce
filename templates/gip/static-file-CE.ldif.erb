<%
name_map=Hash.new
voswdir=Hash.new
voappdir=Hash.new
defaultse=Hash.new
@voenv.each do | voshortname, value |
  name_map[value['voname']]=voshortname
  voswdir[value['voname']]=value['vo_sw_dir']
  voappdir[value['voname']]=value['vo_app_dir']
  defaultse[value['voname']]=value['vo_default_se']
end-%>


<%@queue_vo_map.each do | queue, vodata | -%>
dn: GlueCEUniqueID=<%=@ce_host-%>:<%=@ce_port-%>/<%=@ce_type-%>-<%=@batch_system-%>-<%=queue-%>,mds-vo-name=resource,o=grid
objectClass: GlueCETop
objectClass: GlueCE
objectClass: GlueCEAccessControlBase
objectClass: GlueCEInfo
objectClass: GlueCEPolicy
objectClass: GlueCEState
objectClass: GlueInformationService
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueCEUniqueID: <%=@ce_host-%>:<%=@ce_port-%>/<%=@ce_type-%>-<%=@batch_system-%>-<%=queue%>
GlueCEHostingCluster: <%=@ce_host%>
GlueCEName: <%=queue%>
GlueCEImplementationName: CREAM
GlueCEImplementationVersion: <%=@creamversion%>
GlueCEInfoGatekeeperPort: <%=@ce_port%>
GlueCEInfoHostName: <%=@ce_host%>
GlueCEInfoLRMSType: <%=@batch_system%>
GlueCEInfoLRMSVersion: not defined
GlueCEInfoTotalCPUs: 0
GlueCEInfoJobManager: <%=@batch_system%>
GlueCEInfoContactString: https://<%=@ce_host-%>:<%=@ce_port-%>/ce-cream/services
GlueCEInfoDataDir: unset
GlueCEStateEstimatedResponseTime: 2146660842
GlueCEStateFreeCPUs: 0
GlueCEStateRunningJobs: 0
GlueCEStateStatus: Production
GlueCEStateTotalJobs: 0
GlueCEStateWaitingJobs: 444444
GlueCEStateWorstResponseTime: 2146660842
GlueCEStateFreeJobSlots: 0
GlueCEPolicyMaxCPUTime: 999999999
GlueCEPolicyMaxRunningJobs: 999999999
GlueCEPolicyMaxTotalJobs: 999999999
GlueCEPolicyMaxWallClockTime: 999999999
GlueCEPolicyMaxObtainableCPUTime: 999999999
GlueCEPolicyMaxObtainableWallClockTime: 999999999
GlueCEPolicyMaxWaitingJobs: 999999999
GlueCEPolicyMaxSlotsPerJob: 999999999
GlueCEPolicyPreemption: 0
GlueCEPolicyPriority: 1
GlueCEPolicyAssignedJobSlots: 0
GlueForeignKey: GlueClusterUniqueID=<%=@ce_host%>
GlueInformationServiceURL: ldap://<%=@fqdn-%>:<%=@info_port-%>/mds-vo-name=<%=@info_type-%>grid
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3
<%@ce_capability.each do | cap |-%>
GlueCECapability:  <%=cap%>
<%end-%>
<% vodata.each do | owner, fqans | -%>
GlueCEInfoApplicationDir: <%=voappdir[owner]%>
GlueCEInfoDefaultSE: <%=defaultse[owner]%>
GlueCEAccessControlBaseRule: VO:<%=owner%>
<%# TODO GlueCEAccessControlBaseRule: VOMS:fqan -%>
<%end%><%# end of vodata.each -%>

<%vodata.each do | owner, fqans | -%>
dn: GlueVOViewLocalID=<%=owner-%>,GlueCEUniqueID=<%=@ce_host-%>:<%=@ce_port-%>/<%=@ce_type-%>-<%=@batch_system-%>-<%=queue-%>,mds-vo-name=resource,o=grid
objectClass: GlueCETop
objectClass: GlueVOView
objectClass: GlueCEInfo
objectClass: GlueCEState
objectClass: GlueCEAccessControlBase
objectClass: GlueCEPolicy
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueVOViewLocalID: <%=owner%>
GlueCEStateRunningJobs: 0
GlueCEStateWaitingJobs: 444444
GlueCEStateTotalJobs: 0
GlueCEStateFreeJobSlots: 0
GlueCEStateEstimatedResponseTime: 2146660842
GlueCEStateWorstResponseTime: 2146660842
GlueCEInfoDefaultSE: <%=defaultse[owner]%>
GlueCEInfoApplicationDir: <%=voswdir[owner]%>
GlueCEInfoDataDir: unset
GlueChunkKey: GlueCEUniqueID=<%=@ce_host-%>:<%=@ce_port-%>/<%=@ce_type-%>-<%=@batch_system-%>-<%=queue%>
GlueCEAccessControlBaseRule: VO:<%=owner%>
<%# TODO GlueCEAccessControlBaseRule: VOMS:fqan -%>
<%# TODO GlueCEAccessControlBaseRule: DENY:fqan -%>
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

<%end%><%# end of vodata.each -%>
<%end%><%# end of queue_vo_map.each -%>
