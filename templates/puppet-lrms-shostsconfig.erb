#!/bin/bash

# Generated by puppet

SHOSTS_FILE=/etc/ssh/shosts.equiv
KNOWN_FILE=/etc/ssh/ssh_known_hosts
KEY_TYPES="rsa1,rsa,dsa"

STATIC_HOSTS="<%=@lrms_host_list%>"
EXTRA_HOSTS="<%=@extra_host_list%>"

<%=@lrms_host_script%> >/tmp/hosts.tmp 2>/dev/null
DYNAMIC_HOSTS=`cat /tmp/hosts.tmp | sed -e '/^#/d'`
rm -f /tmp/hosts.tmp

echo "#Generated by puppet, DO NOT EDIT" > ${SHOSTS_FILE}
for HOST in ${STATIC_HOSTS} ${DYNAMIC_HOSTS} ${EXTRA_HOSTS} ; do echo ${HOST}; done | sort | uniq >> ${SHOSTS_FILE}


echo "#Generated by puppet, DO NOT EDIT" > ${KNOWN_FILE}
/usr/bin/ssh-keyscan -t ${KEY_TYPES} -f ${SHOSTS_FILE} >>${KNOWN_FILE} 2>/dev/null

exit 0



